(this.webpackJsonphttpsringofcards=this.webpackJsonphttpsringofcards||[]).push([[0],{27:function(e,t,a){e.exports=a(39)},32:function(e,t,a){},34:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(14),s=a.n(i),l=(a(32),a(4)),o=a.n(l),c=a(9),u=a(17),m=a(22),d=a(23),p=a(26),h=a(25),g=(a(34),a(15)),f=a(7),y=a(12),k=a(11),v=a(10),E=function(e){return r.a.createElement(g.a,{style:{height:"100vh"}},r.a.createElement(y.a,null,r.a.createElement(f.a,{md:2,lg:3,xl:4}),r.a.createElement(f.a,{sm:12,md:8,lg:6,xl:4},r.a.createElement("h1",{style:{fontWeight:900,paddingTop:"12vmin",paddingBottom:"0"}},"Ring of Cards")),r.a.createElement(f.a,{md:2,lg:3,xl:4})),r.a.createElement(y.a,null,r.a.createElement(f.a,{xs:2,md:2,lg:3,xl:4}),r.a.createElement(f.a,{xs:8,sm:10,md:8,lg:6,xl:4},r.a.createElement(k.a,{noValidate:!0,onSubmit:e.submitHandler},r.a.createElement(k.a.Group,{controlId:e.prefix+"name",style:{paddingTop:"8vh"}},r.a.createElement(k.a.Label,null,"Name"),r.a.createElement(k.a.Control,{placeholder:"Pick a name",name:e.prefix+"name",value:e.name,onChange:e.changeHandler,maxLength:"16",required:!0}),r.a.createElement(k.a.Text,{className:"error"},e.errors.name)),r.a.createElement(k.a.Group,{controlId:"formType",style:{paddingTop:"1vh"}},[{value:"Join",label:"Join a game"},{value:"Create",label:"Create a new game"}].map((function(t){return r.a.createElement(k.a.Check,{type:"radio",id:"radio-"+t.value,key:t.value,label:t.label,value:t.value,checked:e.join_or_create===t.value,name:e.prefix+"join_or_create",onChange:e.changeHandler})})),r.a.createElement(k.a.Text,{className:"error"},e.errors.join_or_create)),r.a.createElement(k.a.Group,{controlId:e.prefix+"code",style:{paddingTop:"1vh",display:"Join"===e.join_or_create?"block":"none"}},r.a.createElement(k.a.Label,null,"Game code"),r.a.createElement(k.a.Control,{placeholder:"8 characters",name:e.prefix+"code",value:e.code,onChange:e.changeHandler,maxLength:"36"}),r.a.createElement(k.a.Text,{className:"error"},e.errors.code)),r.a.createElement(k.a.Group,{controlId:"formSubmit",style:{paddingTop:"1vh"}},r.a.createElement(v.a,{variant:"success",type:"submit",disabled:e.submitDisabled},e.join_or_create),r.a.createElement(k.a.Text,null,"By playing you agree to the",r.a.createElement("button",{style:{border:"none",backgroundColor:"rgba(0,0,0,0)",color:"#57f"},onClick:e.showTerms},"terms"),"."),r.a.createElement(k.a.Text,{className:"error"},e.errors.submit))))))},b=a(19),_=a(16),x=function(e){return r.a.createElement("li",null,e.player.name,e.player.is_me?r.a.createElement("span",{className:"badgeContainer"},r.a.createElement(_.a,{pill:!0,variant:"warning"},"me")):null,e.player.is_leader?r.a.createElement("span",{className:"badgeContainer"},r.a.createElement(_.a,{pill:!0,variant:"secondary",title:"Hosts can restart games, open lobbies, and pause players"},"host")):null,e.player.is_paused?r.a.createElement("span",{className:"badgeContainer"},r.a.createElement(_.a,{pill:!0,variant:"secondary",title:"While paused, this players turns are skipped"},"paused")):null,e.player.is_next?r.a.createElement("span",{className:"badgeContainer"},r.a.createElement(_.a,{pill:!0,variant:"success"},"picking")):null)},w=function(e){return r.a.createElement("ol",{className:"PlayerList"},e.players.map((function(t,a){return r.a.createElement(x,{key:a,player:Object(b.a)(Object(b.a)({},t),{},{is_next:a===e.nextPosition,is_me:a===e.me_index})})})))},C=function(e){return r.a.createElement("div",{style:{marginBottom:"8px"}},r.a.createElement(v.a,{variant:"danger",onClick:e.quitClickHandler},"Quit"))},H=function(e){return r.a.createElement(g.a,{style:{height:"100vh"}},r.a.createElement(y.a,null,r.a.createElement(f.a,{md:2,lg:3,xl:4}),r.a.createElement(f.a,{sm:12,md:8,lg:6,xl:4},r.a.createElement("h1",{style:{fontWeight:900,paddingTop:"3vmin",paddingBottom:"3vmin"}},"Lobby"))),r.a.createElement(y.a,null,r.a.createElement(f.a,{md:2,lg:3,xl:4}),r.a.createElement(f.a,{sm:12,md:8,lg:6,xl:4},r.a.createElement("small",{style:{textAlign:"left",marginBottom:"0",paddingBottom:"0"}},e.game.id),r.a.createElement("p",{style:{color:"#ccc",fontSize:"smaller"}},"Share this code to invite friends"))),r.a.createElement(y.a,null,r.a.createElement(f.a,{md:2,lg:3,xl:4}),r.a.createElement(f.a,{sm:12,md:8,lg:6,xl:4},r.a.createElement(C,{quitClickHandler:e.quitClickHandler}),e.player.is_leader?r.a.createElement(k.a.Group,{controlId:"formSubmit"},r.a.createElement(v.a,{variant:"success",type:"submit",onClick:e.beginClickHandler},"Go to game"),r.a.createElement("p",{style:{color:"#ccc",fontSize:"smaller"}},"Only the host (you) can see this button.")):r.a.createElement("h5",null,r.a.createElement("span",null,r.a.createElement("svg",{className:"spinner",height:"16",width:"16"},r.a.createElement("circle",{cx:"8",cy:"8",r:"6",stroke:"#888",strokeWidth:"3",strokeDasharray:"20,12",strokeLinecap:"round",fill:"none"}))),r.a.createElement("span",{style:{paddingLeft:"4px"}},"Waiting for host to close the lobby")))),r.a.createElement(y.a,null,r.a.createElement(f.a,{md:2,lg:3,xl:4}),r.a.createElement(f.a,{sm:12,md:8,lg:6,xl:4},r.a.createElement("h2",{style:{fontWeight:900,paddingTop:"3vmin",marginBottom:"0",paddingBottom:"0"}},"Players"),r.a.createElement("p",{style:{color:"#ccc",fontSize:"smaller"}},"Lobby can be opened mid-game to let more players in."),r.a.createElement(w,{players:e.game.players,me_index:e.player.position}))))},S=function(e){return r.a.createElement("g",null,r.a.createElement("rect",{onClick:function(){return e.onClickHandler?e.onClickHandler(e.card):null},x:e.left_x,y:e.top_y,width:e.width,height:e.height,rx:e.cornerRadius,ry:e.cornerRadius,style:{fill:e.fill,strokeWidth:3,stroke:"#eee"}}),e.faceUp&&r.a.createElement("g",{fill:e.card<26?"#e34":"#222"},r.a.createElement("text",{x:e.left_x,y:e.top_y+e.height-2,fontSize:e.height/6},["\u2665","\u2666","\u2660","\u2663"][Math.floor(e.card/13)]),r.a.createElement("text",{x:e.left_x+(e.card%13===9?.03:.19)*e.height,y:e.top_y+.65*e.height,fontSize:.5*e.height,fontWeight:"900",fontFamily:"monospace"},["A","2","3","4","5","6","7","8","9","10","J","Q","K"][e.card%13])))},T=function(e){var t=e.sideLength/2;return r.a.createElement("svg",{height:e.sideLength,width:e.sideLength,className:"board"},r.a.createElement("g",{transform:"scale(1 1)"},r.a.createElement("defs",null,r.a.createElement("pattern",{id:"faceDown",x:"0",y:"0",width:"9",height:"9",patternUnits:"userSpaceOnUse"},r.a.createElement("rect",{x:"0",y:"0",height:"9",width:"9",fill:"#227"}),r.a.createElement("g",{transform:"rotate(45, 5, 5)"},r.a.createElement("rect",{x:"2",y:"2",height:"5",width:"5",fill:"#bbb"}))),r.a.createElement("pattern",{id:"faceUp",x:"0",y:"0",width:"10",height:"10",patternUnits:"userSpaceOnUse"},r.a.createElement("rect",{x:"0",y:"0",height:"10",width:"10",fill:"#eee"}))),e.game.angles.map((function(a,n){return r.a.createElement("g",{key:n,transform:"rotate("+a+", "+t+","+t+")"},!e.game.picks.includes(n)&&r.a.createElement(S,{onClickHandler:e.onCardClickHandler,fill:"url(#faceDown)",left_x:e.sideLength/2-e.cardWidth/2,top_y:e.sidePadding,width:e.cardWidth,height:e.cardHeight,cornerRadius:e.cardCornerRadius,faceUp:!1,card:n}))})),r.a.createElement("g",{className:"latestCard"},null!==e.game.latest_card_deck_index?r.a.createElement(S,{fill:"url(#faceUp)",left_x:t-e.cardWidth/2,top_y:t-e.cardHeight/2,width:e.cardWidth,height:e.cardHeight,cornerRadius:e.cardCornerRadius,faceUp:!0,card:+e.game.latest_card_deck_index}):null)))},j=function(e){var t,a,n,i=(t=e.value,a=e.name,n=e.seeingDuck,{Ace:{title:"Waterfall",rule:"Everyone begins drinking, you can stop when the person before you stops"},Two:{title:"You",rule:"".concat(a," chooses someone to drink")},Three:{title:"Me",rule:"".concat(a," takes a drink")},Four:{title:"Se\xf1or",rule:"Males drink"},Five:{title:"Webcam Master",rule:"The next time ".concat(a," covers their webcam, everyone else must too. Last one drinks")},Six:{title:"Chicks",rule:"Females drink"},Seven:{title:"Heaven",rule:"Last one pointing to the sky drinks"},Eight:{title:"Mate",rule:"".concat(a," picks someone who will drink every time they do")},Nine:{title:"Rhyme",rule:"".concat(a," picks a word, go round the circle saying a rhyme with it. First to fail drinks")},Ten:{title:"Categories",rule:"".concat(a," picks a category (e.g. counties), go round the circle giving examples of the category. First to fail drinks")},Jack:{title:"Quack",rule:"Anyone who sees a duck at the end of this sentence, take a drink ".concat(n?"\ud83e\udd86":"")},Queen:{title:"Question Master",rule:"".concat(a," is now the question master. If they ask you a question, you must reply with a question or drink.")},King:{title:"Sing",rule:"The group picks a song. ".concat(a," can sing the chorus or take a drink")}}[t]);return r.a.createElement("div",{style:{textAlign:"center",padding:"4px"}},r.a.createElement("strong",null,e.name," got a",["Ace","Eight"].includes(e.value)?"n":""," ",e.value),r.a.createElement("br",null),r.a.createElement("strong",null,e.value," is ",i.title," :")," ",i.rule)},O=function(e){var t;return r.a.createElement(g.a,{style:{height:"200vh"}},r.a.createElement(y.a,null,r.a.createElement(f.a,{className:"d-none d-lg-block",lg:12,xl:12},r.a.createElement("div",{style:{height:"10vh"}})),r.a.createElement(f.a,{className:"d-none d-md-block",md:3,lg:2,xl:2}),r.a.createElement(f.a,{sm:12,md:6,lg:5,xl:5,style:{border:" solid 0px rgba(255,255,255,0.5)"}},r.a.createElement("div",{style:{textAlign:"center",borderRadius:".25rem",border:" solid 2px rgba(255,255,255,0.0)"}},r.a.createElement(T,{game:e.game,sideLength:300,radius:100,sidePadding:20,cardWidth:50,cardHeight:70,cardCornerRadius:3,onCardClickHandler:e.cardPickHandler}),null!==e.game.latest_position&&r.a.createElement(j,{name:e.game.players[e.game.latest_position].name,value:(t=e.game.latest_card_deck_index,["Ace","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Jack","Queen","King"][t%13]),seeingDuck:e.seeingDuck}))),r.a.createElement(f.a,{md:3,lg:0,className:"d-lg-none d-xl-none"}),r.a.createElement(f.a,{md:3,lg:0,className:"d-lg-none d-xl-none"}),r.a.createElement(f.a,{sm:12,md:6,lg:5,xl:5,style:{border:" solid 0px rgba(0,0,0,0.5)"}},r.a.createElement("div",{style:{borderRadius:".25rem",border:" solid 2px rgba(255,255,255,0.0)"}},r.a.createElement("h4",{style:{fontWeight:900,paddingTop:"3vmin",marginBottom:"0",paddingBottom:"10px"}},"Players"),r.a.createElement(w,{players:e.game.players,nextPosition:e.game.next_position,me_index:e.player.position}),r.a.createElement("br",null),r.a.createElement(v.a,{variant:"secondary",onClick:e.pauseClickHandler},e.player.is_paused?"Un-Pause":"Pause"," me"),r.a.createElement("p",{style:{color:"#ccc",fontSize:"smaller",marginBottom:"8px"}},"While paused, your turns are skipped"),r.a.createElement(C,{quitClickHandler:e.quitClickHandler}),e.player.is_leader&&r.a.createElement("div",{style:{border:"solid 2px #888",borderRadius:"5px",padding:"5px"}},r.a.createElement("h3",null,"Host Options"),r.a.createElement(v.a,{variant:"secondary",onClick:e.lobbyClickHandler},"Go to lobby"),r.a.createElement("p",{style:{color:"#ccc",fontSize:"smaller"}},"In the lobby, more players can join"),r.a.createElement(v.a,{variant:"secondary",onClick:e.restartClickHandler},"Restart"),r.a.createElement("p",{style:{color:"#ccc",fontSize:"smaller"}},"Put all the cards back"))))))},P=a(8),G=function(e){return r.a.createElement(P.a,{show:e.isAsleep,onHide:e.wakeupClickHandler,animation:!1},r.a.createElement(P.a.Header,{closeButton:!0},r.a.createElement(P.a.Title,null,"Are you still there?")),r.a.createElement(P.a.Body,null,"Nothings happened in the past ",e.waitTime," so I stopped checking for updates. Close this pop-up and I will start checking again."),r.a.createElement(P.a.Footer,null,r.a.createElement(v.a,{variant:"secondary",onClick:e.wakeupClickHandler},"Close")))},D=function(e,t,a){var n=new Date;n.setTime(n.getTime()+60*a*1e3);var r="expires="+n.toUTCString();document.cookie=e+"="+t+";"+r+";path=/"},L=function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var r=a[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""},N=function(e,t,a){L(e)&&(document.cookie=e+"="+(t?";path="+t:"")+(a?";domain="+a:"")+";expires=Thu, 01 Jan 1970 00:00:01 GMT")},R=function(e){return r.a.createElement(P.a,{show:!e.acceptedCookies,onHide:function(){return console.log("HIDDEN")},animation:!1},r.a.createElement(P.a.Header,null,r.a.createElement(P.a.Title,null,"Cookies")),r.a.createElement(P.a.Body,null,"This site uses ",r.a.createElement("a",{href:"/cookies/",target:"_blank"},"cookies")," to work."),r.a.createElement(P.a.Footer,null,r.a.createElement(v.a,{variant:"success",onClick:e.acceptClickHandler},"Accept Cookies")))},A=function(e){return r.a.createElement(P.a,{show:e.isQuitting,onHide:e.cancelHandler,animation:!1},r.a.createElement(P.a.Header,null,r.a.createElement(P.a.Title,null,"Quit?")),r.a.createElement(P.a.Body,null,"You will be permanently paused in this game. You can return to it by joining again."),r.a.createElement(P.a.Footer,null,r.a.createElement(v.a,{variant:"danger",onClick:e.quitHandler},"Quit"),r.a.createElement(v.a,{variant:"success",onClick:e.cancelHandler},"Stay")))},I=function(e){return r.a.createElement(P.a,{show:e.showTerms,onHide:e.hideTerms,animation:!1},r.a.createElement(P.a.Header,null,r.a.createElement(P.a.Title,null,"Terms")),r.a.createElement(P.a.Body,null,r.a.createElement("h3",null,"Privacy Policy"),r.a.createElement("p",null,"The name you submit and involvement in games is stored."),r.a.createElement("h3",null,"Cookie Policy"),r.a.createElement("p",null,"Cookies are used for the site to function."),r.a.createElement("p",null,"Cookies are used to measure, for example, how many games are played at a time."),r.a.createElement("p",null,"By using the site you agree to use of all such cookies."),r.a.createElement("h3",null,"Terms"),r.a.createElement("p",null,"This site is currently available to use for free and comes with no warranty."),r.a.createElement("p",null,"The owner of this site shall not be liable for any damages to property or losses caused by using this site")),r.a.createElement(P.a.Footer,null,r.a.createElement(v.a,{variant:"success",onClick:e.hideTerms},"OK")))},q=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).changeHandler=function(e){var t=e.target.name,a=e.target.value;n.setState(Object(u.a)({},t,a))},n.homeSubmitHandler=function(e){e.preventDefault();var t=n.state.home_errors,a=!0;if(n.state.home_input_name.length<1?(t.name="Name is required",a=!1):t.name="","Join"===n.state.home_input_join_or_create&&36!==n.state.home_input_code.length?(t.code="36 character code is required to join a game",a=!1):t.code="",["Join","Create"].includes(n.state.home_input_join_or_create)?t.join_or_create="":(t.join_or_create="Choice of join or create is required",a=!1),!a)return n.setState({home_errors:t}),void console.log("nope");console.log("yep"),n.setState({home_input_submit_disabled:!0}),console.log(n.state.home_input_join_or_create),"Create"===n.state.home_input_join_or_create?n.createGame().catch((function(e){var t=n.state.home_errors;t.submit="Cannot create game",n.setState({home_errors:t}),n.setState({home_input_submit_disabled:!1})})):n.joinGame().catch((function(e){var t=n.state.home_errors;t.submit="Cannot join game"+("400"===e.message?" make sure the host is in the lobby.":""),n.setState({home_errors:t}),n.setState({home_input_submit_disabled:!1})}))},n.state={apiUrl:"https://immense-retreat-33385.herokuapp.com/",home_input_name:"Thomas",home_input_code:"cd9fc042-c381-4a3f-9cbe-827afe0fc162",home_input_join_or_create:"Join",home_input_submit_disabled:!1,home_errors:{name:"",code:"",input_join_or_create:"",submit:"",joinGame:"",poll_game:""},cardPicked:0,seeingDuck:!0,errors:{create_game:"",join_game:""},acceptedCookies:!0,pollingAsleep:!1,isQuitting:!1,showTerms:!1,player:{id:"829cc7da-b6a4-4e00-bcc0-60227c424c16",updated_at:"2020-05-11T17:35:36.732586+01:00",name:"Thomas",position:4,is_leader:!1,is_paused:!1}},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.pollingId=setInterval((function(){return e.PollGame()}),3e3),""===L("accepted")&&this.setState({acceptedCookies:!1});var t=L("playerId"),a=L("playerPosition"),n=L("gameId");console.log("Cookies"),console.log(t),console.log(a),console.log(n),""!==t&&""!==n&&""!==a&&this.getGame(n).then((function(t){return e.setState({game:t}),t.players[+a]})).then((function(n){return e.setState({player:{id:t,is_leader:n.is_leader,is_paused:n.is_paused,name:n.name,updated_at:new Date,position:+a}})})).catch((function(t){console.log("Restore from cookies failed"),e.setState({game:void 0,player:void 0})}))}},{key:"componentWillUnmount",value:function(){clearInterval(this.pollingId)}},{key:"getData",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.state.apiUrl+t).then((function(e){if(200!==e.status)throw new Error(e.status);return e}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendData",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n,r,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:"POST",e.next=3,fetch(this.state.apiUrl+t,{method:n,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(![200,201].includes(e.status))throw new Error(e.status);return e}));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"postGameResponse",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendData("games/",{});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postGame",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.postGameResponse();case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"postPlayerResponse",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendData("players/",{name:t,game:a});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"postPlayer",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.postPlayerResponse(t,a);case 2:if(201===(n=e.sent).status){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getGameResponse",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("games/".concat(t,"/"));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getGame",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getGameResponse(t);case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"patchGameResponse",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendData("games/".concat(t,"/"),a,"PATCH");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"patchGame",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.patchGameResponse(t,a);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"patchPlayerResponse",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendData("players/".concat(t,"/"),a,"PATCH");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"patchPlayer",value:function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.patchPlayerResponse(t,a);case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"createGame",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.postGame();case 3:return t=e.sent,e.next=6,this.postPlayer(this.state.home_input_name,t.id);case 6:return a=e.sent,e.next=9,this.getGame(t.id);case 9:n=e.sent,this.setState({game:n,player:a}),this.updateLastEvent(),D("gameId",n.id,8),D("playerId",a.id,8),D("playerPosition",a.position,8),e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(0),e.t0;case 20:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"joinGame",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.postPlayer(this.state.home_input_name,this.state.home_input_code);case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return","error");case 5:return e.next=7,this.getGame(this.state.home_input_code);case 7:a=e.sent,this.setState({game:a,player:t}),this.updateLastEvent(),D("gameId",a.id,8),D("playerId",t.id,8),D("playerPosition",t.position,8);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"PollGame",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof this.state.game){e.next=2;break}return e.abrupt("return");case 2:if(!(+new Date/1e3>+this.state.lastEvent/1e3+10)){e.next=5;break}return this.state.pollingAsleep||(console.log("SLEEPING"),this.setState({pollingAsleep:!0})),e.abrupt("return");case 5:return this.setState({pollingAsleep:!1}),this.setState({home_input_submit_disabled:!1}),e.next=9,this.getData("poll/".concat(this.state.game.id,"/"));case 9:return t=e.sent,e.next=12,t.json();case 12:if(a=e.sent,a.last_updated===+this.state.game.last_updated){e.next=21;break}return e.next=17,this.getGame(this.state.game.id);case 17:(n=e.sent).picks.length!==this.state.game.picks.length&&this.setState({seeingDuck:Math.random()>.6}),this.setState({game:n}),this.updateLastEvent();case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gameStateChangeClickHandler",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={player_id:this.state.player.id,is_in_lobby:t},e.prev=1,e.next=4,this.patchGame(this.state.game.id,a);case 4:n=e.sent,this.setState({game:n}),this.updateLastEvent(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("COULD NOT UPDATE");case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"restartClickHandler",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={player_id:this.state.player.id,restart:!0},e.prev=1,e.next=4,this.patchGame(this.state.game.id,t);case 4:a=e.sent,this.setState({game:a}),this.updateLastEvent(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("COULD NOT RESTART");case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"cardPickHandler",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.game.next_position===this.state.player.position){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.setState({seeingDuck:Math.random()>.6}),a={player_id:this.state.player.id,card_index:t},e.next=7,this.patchGame(this.state.game.id,a);case 7:n=e.sent,this.setState({game:n}),this.updateLastEvent(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("COULD NOT PICK");case 15:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseClickHandler",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={is_paused:!this.state.player.is_paused},e.next=3,this.patchPlayer(this.state.player.id,t);case 3:a=e.sent,this.setState({player:a}),this.updateLastEvent();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateLastEvent",value:function(){this.setState({pollingAsleep:!1,lastEvent:new Date})}},{key:"wakeupClickHandler",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.updateLastEvent();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"acceptCookies",value:function(){D("accepted",!0,1440),this.setState({acceptedCookies:!0}),console.log(this.state.acceptedCookies)}},{key:"quitHandler",value:function(){this.pauseClickHandler(),this.setState({isQuitting:!1}),N("playerId","/"),N("gameId","/"),N("position","/"),this.setState({game:void 0})}},{key:"quitClickHandler",value:function(){this.setState({isQuitting:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(I,{showTerms:this.state.showTerms,hideTerms:function(){return e.setState({showTerms:!1})}}),r.a.createElement(A,{isQuitting:this.state.isQuitting,cancelHandler:function(){return e.setState({isQuitting:!1})},quitHandler:this.quitHandler.bind(this)}),r.a.createElement(R,{acceptedCookies:this.state.acceptedCookies,acceptClickHandler:this.acceptCookies.bind(this)}),("undefined"===typeof this.state.game||0===this.state.game.players.length)&&r.a.createElement(E,{prefix:"home_input_",errors:this.state.home_errors,name:this.state.home_input_name,code:this.state.home_input_code,join_or_create:this.state.home_input_join_or_create,changeHandler:this.changeHandler.bind(this),submitHandler:this.homeSubmitHandler.bind(this),submitDisabled:this.state.home_input_submit_disabled,showTerms:function(){return e.setState({showTerms:!0})}}),"undefined"!==typeof this.state.game&&(this.state.game.is_in_lobby?r.a.createElement(H,{game:this.state.game,player:this.state.player,beginClickHandler:this.gameStateChangeClickHandler.bind(this,!1),quitClickHandler:this.quitClickHandler.bind(this)}):r.a.createElement(O,{game:this.state.game,player:this.state.player,lobbyClickHandler:this.gameStateChangeClickHandler.bind(this,!0),pauseClickHandler:this.pauseClickHandler.bind(this),cardPickHandler:this.cardPickHandler.bind(this),restartClickHandler:this.restartClickHandler.bind(this),seeingDuck:this.state.seeingDuck,quitClickHandler:this.quitClickHandler.bind(this)})),this.state.pollingAsleep&&r.a.createElement(G,{isAsleep:this.state.pollingAsleep,waitTime:"5 minutes",wakeupClickHandler:this.wakeupClickHandler.bind(this)}))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(38);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.a6368466.chunk.js.map