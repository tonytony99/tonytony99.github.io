import{S as t,P as i,W as e,G as s,T as a,R as n,C as o,M as h,a as d,b as r,A as c,V as l,c as p,d as w,e as m}from"./vendor.f697fc00.js";const x=t=>Math.PI/180*t,g=new t,u=new m,M=new i(75,window.innerWidth/window.innerHeight,.1,1e3),z=new e({canvas:document.querySelector("#bg")}),P=new s;M.position.set(0,10,0);class y{constructor({x:t,z:i,theta:e}){const s=new d(new w(14,7,1,1),S);s.rotation.x=-Math.PI/2,s.rotation.z=e,s.position.y=.1,s.position.x=t,s.position.z=i,this.position=s.position,g.add(s)}}z.setPixelRatio(window.devicePixelRatio),z.setSize(window.innerWidth,window.innerHeight),z.render(g,M);const b=(new a).load("textures/lawn_texture.jpg");b.wrapS=n,b.wrapT=n,b.repeat.set(20,20);let v=new o(100,100),A=new h({map:b}),I=new d(v,A);I.rotation.x=-Math.PI/2,I.position.y=0,I.position.x=0,I.position.z=0,g.add(I);const S=new h({map:(new a).load("textures/blanket_texture.png")});const R=[{x:-5,z:-20,theta:-3.1}].map((t=>new y(t))),f=new class{constructor(t,i){this.theta=t,this.target=i,this.state="created"}setState(t){this.state=t,this.action&&this.action.stop(),"approaching"===t&&(this.action=this.mixer.clipAction(this.model.animations[2]),this.action.play()),"watching"===t&&(this.action=this.mixer.clipAction(this.model.animations[0]),this.action.play())}updateRotation(){this.dx=this.model.scene.position.x-this.target.position.x,this.dz=this.model.scene.position.z-this.target.position.z,this.targetAngle=Math.PI+Math.atan2(this.dx,this.dz),this.model.scene.rotation.y=this.model.scene.rotation.y%(2*Math.PI),this.dr=(this.targetAngle-this.model.scene.rotation.y)%(2*Math.PI),Math.abs(this.dr)>.2&&(this.dr>=Math.PI?this.model.scene.rotation.y-=.05:this.model.scene.rotation.y+=.05)}updatePosition(){this.updateRotation(),this.dist=(this.dx**2+this.dz**2)**.5,this.dist>1&&(this.model.scene.position.x-=.2*this.dx/this.dist,this.model.scene.position.z-=.2*this.dz/this.dist)}async enter(){var t;this.model=await(t="with_peck.glb",new Promise(((i,e)=>{P.load(t,(t=>i(t)),null,e)}))),this.mixer=new p(this.model.scene),g.add(this.model.scene),this.model.scene.position.x=50*Math.cos(this.theta),this.model.scene.position.z=50*Math.sin(this.theta),this.updatePosition(),this.setState("approaching")}}(x(-90),R[0]),W=new r(16777215);W.position.set(5,5,5);const _=new c(16777215,2);g.add(W,_),M.rotation.x=x(-20),console.log(M),function t(){"created"===f.state&&f.enter(),"approaching"===f.state&&(f.updatePosition(),f.dist<=1&&f.setState("watching")),"watching"===f.state&&(f.target=M,f.updateRotation()),requestAnimationFrame(t);var i=u.getDelta();f.mixer&&f.mixer.update(i),z.render(g,M)}();let j=0,k=0,q=0;window.addEventListener("deviceorientation",(t=>{var i=null===t.alpha?0:t.alpha,e=null===t.beta?0:t.beta,s=null===t.gamma?0:t.gamma;const a=s-q,n=i-j,o=e-k;Math.abs(n)>.5&&(M.rotateOnWorldAxis(new l(0,1,0),x(n)),j=i),Math.abs(a)>.5&&(M.rotateY(x(a)),q=s),Math.abs(o)>.5&&(M.rotateX(x(o)),k=e)}));
