import{S as t,P as i,W as e,G as s,T as o,R as a,C as n,M as h,a as r,b as d,A as c,V as l,c as p,d as w,e as m}from"./vendor.f697fc00.js";const x=t=>Math.PI/180*t,g=new t,u=new m,z=new i(75,window.innerWidth/window.innerHeight,.1,1e3),P=new e({canvas:document.querySelector("#bg")}),y=new s;z.position.set(0,10,0);class M{constructor({x:t,z:i,theta:e}){const s=new r(new w(14,7,1,1),S);s.rotation.x=-Math.PI/2,s.rotation.z=e,s.position.y=.1,s.position.x=t,s.position.z=i,this.position=s.position,g.add(s)}}P.setPixelRatio(window.devicePixelRatio),P.setSize(window.innerWidth,window.innerHeight),P.render(g,z);const v=(new o).load("textures/lawn_texture_small.jpg");v.wrapS=a,v.wrapT=a,v.repeat.set(14,14);let b=new n(100,100),A=new h({map:v}),I=new r(b,A);I.rotation.x=-Math.PI/2,I.position.y=0,I.position.x=0,I.position.z=0,g.add(I);const S=new h({map:(new o).load("textures/blanket_texture.png")});const R=[{x:-5,z:-20,theta:-3.1},{x:-30,z:-30,theta:-.3},{x:3,z:-40,theta:-2.2},{x:20,z:-28,theta:3.1},{x:-20,z:-40,theta:-.9}].map((t=>new M(t))),f=new class{constructor(t,i){this.theta=t,this.target=i,this.state="created"}setState(t){this.state=t,this.action&&this.action.stop(),"approaching"===t&&(this.action=this.mixer.clipAction(this.model.animations[2]),this.action.play()),"watching"===t&&(this.action=this.mixer.clipAction(this.model.animations[0]),this.action.play())}updateRotation(){this.dx=this.model.scene.position.x-this.target.position.x,this.dz=this.model.scene.position.z-this.target.position.z,this.targetAngle=Math.PI+Math.atan2(this.dx,this.dz),this.model.scene.rotation.y=this.model.scene.rotation.y%(2*Math.PI),this.dr=(this.targetAngle-this.model.scene.rotation.y)%(2*Math.PI),Math.abs(this.dr)>.2&&(this.dr>=Math.PI?this.model.scene.rotation.y-=.05:this.model.scene.rotation.y+=.05)}updatePosition(){this.updateRotation(),this.dist=(this.dx**2+this.dz**2)**.5,this.dist>1&&(this.model.scene.position.x-=.2*this.dx/this.dist,this.model.scene.position.z-=.2*this.dz/this.dist)}async enter(){var t;this.model=await(t="with_peck.glb",new Promise(((i,e)=>{y.load(t,(t=>i(t)),null,e)}))),this.mixer=new p(this.model.scene),g.add(this.model.scene),this.model.scene.position.x=50*Math.cos(this.theta),this.model.scene.position.z=50*Math.sin(this.theta),this.updatePosition(),this.setState("approaching")}}(x(-90),R[0]),W=new d(16777215);W.position.set(5,5,5);const _=new c(16777215,2);let j;g.add(W,_),console.log(z),function t(){"created"===f.state&&f.enter(),"approaching"===f.state&&(f.updatePosition(),f.dist<=1&&f.setState("watching")),"watching"===f.state&&(f.target=z,f.updateRotation()),requestAnimationFrame(t);var i=u.getDelta();f.mixer&&f.mixer.update(i),P.render(g,z)}(),z.rotation.x=0,z.rotation.y=0,z.rotation.z=0,window.addEventListener("deviceorientation",(t=>{z.rotation.x=0,z.rotation.y=0,z.rotation.z=0;var i=null===t.alpha?0:t.alpha,e=null===t.beta?0:t.beta,s=null===t.gamma?0:t.gamma;j||(j=i),(i-=j)>90&&(i=90),i<-90&&(i=-90),console.log(i),z.rotateOnWorldAxis(new l(0,1,0),x(i)),z.rotateY(x(s)),z.rotateX(x(-90+e))}));
